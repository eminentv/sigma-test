alert:
- debug
description: Detects registry keys created in OceanLotus (also known as APT32) attacks
filter:
- query:
    query_string:
      query: ((TargetObject:"HKCU\\SOFTWARE\\Classes\\CLSID\\\{E08A0F4B\-1F65\-4D4D\-9A09\-BD4625B9C5A1\}\\Model" OR (TargetObject.keyword:(HKCU\\SOFTWARE\\App\\* OR HKLM\\SOFTWARE\\App\\*) AND TargetObject.keyword:(*AppXbf13d4ea2945444d8b13e2121cb6b663\\* OR *AppX70162486c7554f7f80f481985d67586d\\* OR *AppX37cc7fdccd644b4f85f4b22d5a3f105a\\*) AND TargetObject.keyword:(*Application OR *DefaultIcon))) OR (TargetObject.keyword:HKCU\\* AND TargetObject.keyword:(*Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\* OR *Classes\\AppX3bbba44c6cae4d9695755183472171e2\\* OR *Classes\\CLSID\\\{E3517E26\-8E93\-458D\-A6DF\-8030BC80528B\}\\* OR *Classes\\CLSID\\\{E08A0F4B\-1F65\-4D4D\-9A09\-BD4625B9C5A1\}\\Model*)))
index: filebeat-*
name: 4ac5fc44-a601-4c06-955b-309df8c4e9d4-OceanLotus-Registry-Activity
priority: 1
realert:
  minutes: 0
type: any

import: BaseHive.config
import: BaseTeams.config
import: BaseRule.config
