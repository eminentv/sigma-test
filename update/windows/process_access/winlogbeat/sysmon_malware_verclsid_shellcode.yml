alert:
- debug
description: Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro
filter:
- query:
    query_string:
      query: ((winlog.event_data.TargetImage.keyword:*\\verclsid.exe AND winlog.event_data.GrantedAccess:"0x1FFFFF") AND ((winlog.event_data.CallTrace.keyword:*|UNKNOWN\(* AND winlog.event_data.CallTrace.keyword:*VBE7.DLL*) OR (winlog.event_data.SourceImage.keyword:*\\Microsoft\ Office\\* AND winlog.event_data.CallTrace.keyword:*|UNKNOWN*)))
index: winlogbeat-*
name: b7967e22-3d7e-409b-9ed5-cdae3f9243a1-Malware-Shellcode-in-Verclsid-Target-Process
priority: 2
realert:
  minutes: 0
type: any

import: BaseHive.config
import: BaseTeams.config
import: BaseRule.config
