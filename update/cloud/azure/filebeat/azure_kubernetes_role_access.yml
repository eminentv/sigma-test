alert:
- debug
description: Identifies when ClusterRoles/Roles are being modified or deleted.
filter:
- query:
    query_string:
      query: properties.message:("MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/WRITE" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/DELETE" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/BIND\/ACTION" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/ROLES\/ESCALATE\/ACTION" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/WRITE" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/DELETE" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/BIND\/ACTION" OR "MICROSOFT.KUBERNETES\/CONNECTEDCLUSTERS\/RBAC.AUTHORIZATION.K8S.IO\/CLUSTERROLES\/ESCALATE\/ACTION")
index: filebeat-*
name: 818fee0c-e0ec-4e45-824e-83e4817b0887-Azure-Kubernetes-Sensitive-Role-Access
priority: 3
realert:
  minutes: 0
type: any

import: BaseHive.config
import: BaseTeams.config
import: BaseRule.config
